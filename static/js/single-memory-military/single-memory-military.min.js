jQuery(document).ready((function(e){e.fn.lettering=function(t){return this.each((function(){var t=e(this).text().replace(/\s+/g," ").split("");console.log(t),e(this).css({visibility:"hidden",overflow:"hidden",position:"relative",width:"100vh"}),e(this).height(e(this).height());for(var i="",o=0;o<t.length;o++)i+="<span>"+t[o]+"</span>";e(this).html(i);var s=[];e(this).find("span").each((function(t,i){s.push({top:e(this).get(0).offsetTop,left:e(this).get(0).offsetLeft})})),console.log(s),e(this).find("span").each((function(t,i){e(this).css({top:s[t].top,left:s[t].left,animationDelay:.1*t+"s"})})),e(this).find("span").addClass("loaded"),e(this).css({visibility:"visible"})}))},e(".single-memory-name").lettering(),e(".single-memory-fight__start-description").outerHeight()>156&&e(".single-memory-fight__item-more").removeClass("hidden"),e(".single-memory-fight__section--over3").click((function(){"1"==e(this).attr("data-modal")&&(e(".single-memory-fight__modal").removeClass("hidden"),e("body").addClass("no-scroll"))})),e(".single-memory-fight__modal__close").click((function(){e(".single-memory-fight__modal").addClass("hidden"),e("body").removeClass("no-scroll")})),e(".single-memory-fight__section canvas").each((function(){var t=e(this).width(),i=e(this).height(),o=["#000000","#4c4636","#2a2519","#3b3629","#433e2f","#4c4636"],s=e(this).get(0).getContext("2d");s.canvas.width=t,s.canvas.height=i;for(var a=0;a<t;a+=30)for(var n=0;n<i;n+=30)s.fillStyle=o[Math.floor(5*Math.random())],2==Math.floor(3*Math.random())&&s.fillRect(a,n,30,30)})),e(window).on("scroll",(function(){if(e(".single-memory-fight").length){var t=e(window).scrollTop(),i=e(".single-memory-fight").offset().top,o=e(".single-memory-fight").height(),s=Math.min(o,Math.max(0,t-i))/o;s<.25?(e(".single-memory-fight__section--over1").css("opacity",s/.25),e(".single-memory-fight__section--over3").css("cursor","pointer").attr("data-modal","1")):s<.5?(e(".single-memory-fight__section--over2").css("opacity",(s-.25)/.25),e(".single-memory-fight__section--over3").css("cursor","default").attr("data-modal","0")):(e(".single-memory-fight__section--over3").css("opacity",(s-.5)/.25),e(".single-memory-fight__section--over3").css("cursor","default").attr("data-modal","0"))}})),"undefined"!=typeof mapboxgl&&"undefined"!=typeof MapboxGeocoder&&e(".mapbox").each((function(){var t=e(this).attr("data-location");mapboxgl.accessToken=e(this).attr("data-key");var i=new mapboxgl.Map({container:e(this).attr("id"),center:[e(this).attr("data-long"),e(this).attr("data-lat")],zoom:17,attributionControl:!1,style:"mapbox://styles/alex-anthracite/clssv42xu00wk01qx2r2gbmpr",hash:!0}),o=new MapboxGeocoder({accessToken:mapboxgl.accessToken,mapboxgl:mapboxgl,marker:!1,showSearch:!1});i.addControl(o),o.on("result",(function(e){var t=e.result.center;i.flyTo({center:t,zoom:12})})),t&&"string"==typeof t&&o.query(t),e(this).attr("data-region")&&i.on("load",(function(){i.addSource("admin-1",{type:"vector",url:"mapbox://mapbox.boundaries-adm1-v4",promoteId:"mapbox_id"}),i.addLayer({id:"admin-1-fill",type:"fill",source:"admin-1","source-layer":"boundaries_admin_1",filter:["any",["==","all",["get","worldview"]],["in","UA",["get","worldview"]]],paint:{"fill-color":"#CCCCCC","fill-opacity":.5}},"waterway-label")}))})),e(".single-memory-rewards__modal__close").click((function(){e(this).closest(".single-memory-rewards__modal").addClass("hidden")})),e(".single-memory-rewards__items__more-btn").click((function(){e(".single-memory-rewards__items-row.hidden:first").removeClass("hidden")})),e(".single-memory-rewards__item-description").each((function(){var t=e(this);t.height()>140&&(t.siblings(".single-memory-rewards__item-more").show(),t.height(144))})),e(".single-memory-rewards__item").click((function(){if(e(this).find(".single-memory-rewards__item-description").height()>140){var t=e(this).attr("data-id");e('.single-memory-rewards__modal[data-id="'+t+'"]').removeClass("hidden")}})),e(".single-memory-top").on("mousemove",(function(t){var i=t.clientX,o=t.clientY;e(".single-memory-top__bg path").each((function(){var t=this.getBoundingClientRect(),s=t.left+t.width/2,a=t.top+t.height/2,n=Math.sqrt(Math.pow(s-i,2)+Math.pow(a-o,2));n<100?e(this).addClass("highlighted-1").removeClass("highlighted-2 highlighted-3 highlighted"):n<250?e(this).addClass("highlighted-2").removeClass("highlighted-1 highlighted-3 highlighted"):n<500?e(this).addClass("highlighted-3").removeClass("highlighted-1 highlighted-2 highlighted"):e(this).removeClass("highlighted-1 highlighted-2 highlighted-3").addClass("highlighted")}))}))}));